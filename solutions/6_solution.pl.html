<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by perltidy on Tue Mar 20 18:50:04 2007 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>solution6.pl</title>
<style type="text/css">
<!--
/* default style sheet generated by perltidy */
body {background: #FFFFFF; color: #000000}
pre { color: #000000; 
      background: #FFFFFF;
      font-family: courier;
    } 

.c  { color: #228B22;} /* comment */
.cm { color: #000000;} /* comma */
.co { color: #000000;} /* colon */
.h  { color: #CD5555; font-weight:bold;} /* here-doc-target */
.hh { color: #CD5555; font-style:italic;} /* here-doc-text */
.i  { color: #00688B;} /* identifier */
.j  { color: #CD5555; font-weight:bold;} /* label */
.k  { color: #8B008B; font-weight:bold;} /* keyword */
.m  { color: #FF0000; font-weight:bold;} /* subroutine */
.n  { color: #B452CD;} /* numeric */
.p  { color: #000000;} /* paren */
.pd { color: #228B22; font-style:italic;} /* pod-text */
.pu { color: #000000;} /* punctuation */
.q  { color: #CD5555;} /* quote */
.s  { color: #000000;} /* structure */
.sc { color: #000000;} /* semicolon */
.v  { color: #B452CD;} /* v-string */
.w  { color: #000000;} /* bareword */
-->
</style>
</head>
<body>
<a name="-top-"></a>
<h1>solution6.pl</h1>
<!-- BEGIN CODE INDEX --><a name="code-index"></a>
<ul>
<li><a href="#__END__-">__END__</a></li>
<li><a href="#EOF-">EOF</a></li>
</ul>
<!-- END CODE INDEX -->
<hr />
<!-- contents of filename: solution6.pl -->
<pre>
#!/usr/bin/perl -w
<span class="c"># Example that shows values returned by Bio::SearchIO::Blast.</span>
<span class="c"># Note that some methods will return objects or arrays, not text.</span>
<span class="c"># For example, $hsp-&gt;get_aln will return a Bio::SimpleAlign object,</span>
<span class="c"># not the alignment in a printable form.</span>
<span class="c"># This script was used to create the table in the SearchIO HOWTO,</span>
<span class="c"># found at http://bioperl.open-bio.org/wiki/HOWTO:SearchIO</span>
<span class="c"># Brian Osborne</span>

<span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
<span class="k">use</span> <span class="w">Bio::SearchIO</span><span class="sc">;</span>
<span class="k">use</span> <span class="w">Bio::SimpleAlign</span><span class="sc">;</span>
<span class="k">use</span> <span class="w">Bio::AlignIO</span><span class="sc">;</span>

<span class="k">my</span> <span class="i">$file</span> = <span class="k">shift</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Usage: $0 &lt;BLAST-report-file&gt;\n&quot;</span><span class="sc">;</span>
<span class="k">my</span> <span class="i">$in</span> = <span class="w">new</span> <span class="i">Bio::SearchIO</span><span class="s">(</span>-<span class="w">format</span> <span class="cm">=&gt;</span> <span class="q">&#39;blast&#39;</span><span class="cm">,</span>
			   <span class="c"># comment out the next line to read STDIN</span>
			   -<span class="w">file</span>   <span class="cm">=&gt;</span> <span class="i">$file</span> <span class="s">)</span><span class="sc">;</span>

<span class="k">while</span> <span class="s">(</span> <span class="k">my</span> <span class="i">$result</span> = <span class="i">$in</span><span class="i">-&gt;next_result</span> <span class="s">)</span> <span class="s">{</span>
<span class="c">#   my @stats =  $result-&gt;available_statistics;</span>
<span class="c">#   my @params = $result-&gt;available_parameters;</span>
<span class="c">#   print &quot;Result\tavailable_statistics\t@stats\n&quot;;</span>
<span class="c">#   print &quot;Result\tavailable_parameters\t@params\n&quot;;</span>
<span class="c">#   print &quot;Result\talgorithm\t&quot; .         $result-&gt;algorithm . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\talgorithm_version\t&quot; . $result-&gt;algorithm_version . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tquery_name\t&quot; .        $result-&gt;query_name . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tquery_accession\t&quot; .   $result-&gt;query_accession . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tquery_length\t&quot; .      $result-&gt;query_length . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tquery_description\t&quot; . $result-&gt;query_description . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tdatabase_name\t&quot; .     $result-&gt;database_name . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tdatabase_letters\t&quot; .  $result-&gt;database_letters . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tdatabase_entries\t&quot; .  $result-&gt;database_entries . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\tnum_hits\t&quot; .          $result-&gt;num_hits . &quot;\n&quot;;</span>
<span class="c">#   print &quot;Result\thits\t&quot; .              $result-&gt;hits . &quot;\n&quot;;</span>

   <span class="k">while</span> <span class="s">(</span> <span class="k">my</span> <span class="i">$hit</span> = <span class="i">$result</span><span class="i">-&gt;next_hit</span> <span class="s">)</span> <span class="s">{</span>

      <span class="k">last</span> <span class="k">unless</span> <span class="i">$hit</span><span class="i">-&gt;significance</span> &lt; <span class="n">1</span><span class="sc">;</span>

<span class="c">#      my $id =         $hit-&gt;matches(&#39;id&#39;);</span>
<span class="c">#      my $cons =       $hit-&gt;matches(&#39;cons&#39;);</span>
      <span class="k">my</span> <span class="i">@accs</span> =       <span class="i">$hit</span><span class="i">-&gt;each_accession_number</span><span class="sc">;</span>
<span class="c">#      my @qidentical = $hit-&gt;seq_inds(&#39;query&#39;,&#39;identical&#39;);</span>
<span class="c">#      my @qconserved = $hit-&gt;seq_inds(&#39;query&#39;,&#39;conserved&#39;);</span>
<span class="c">#      my @hidentical = $hit-&gt;seq_inds(&#39;hit&#39;,&#39;identical&#39;);</span>
<span class="c">#      my @hconserved = $hit-&gt;seq_inds(&#39;hit&#39;,&#39;conserved&#39;);</span>
<span class="c">#      print &quot;Hit\tseq_inds(&#39;query&#39;,&#39;identical&#39;)\t@qidentical\n&quot;;</span>
<span class="c">#      print &quot;Hit\tseq_inds(&#39;query&#39;,&#39;conserved&#39;)\t@qconserved\n&quot;;</span>
<span class="c">#      print &quot;Hit\tseq_inds(&#39;hit&#39;,&#39;identical&#39;)\t@hidentical\n&quot;;</span>
<span class="c">#      print &quot;Hit\tseq_inds(&#39;hit&#39;,&#39;conserved&#39;)\t@hconserved\n&quot;;</span>
      <span class="k">print</span> <span class="q">&quot;Hit\teach_accession_number\t@accs\n&quot;</span><span class="sc">;</span>
<span class="c">#      print &quot;Hit\tmatches(&#39;id&#39;)\t&quot; . $id . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tmatches(&#39;cons&#39;)\t&quot; . $cons . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tname\t&quot; .                $hit-&gt;name . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\taccession\t&quot; .           $hit-&gt;accession . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tdescription\t&quot; .         $hit-&gt;description . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tlength\t&quot; .              $hit-&gt;length . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\talgorithm\t&quot; .           $hit-&gt;algorithm . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\traw_score\t&quot; .           $hit-&gt;raw_score . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tsignificance\t&quot; .        $hit-&gt;significance . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tbits\t&quot; .                $hit-&gt;bits . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\thsps\t&quot; .                $hit-&gt;hsps . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tnum_hsps\t&quot; .            $hit-&gt;num_hsps . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tambiguous_aln\t&quot; .       $hit-&gt;ambiguous_aln . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\toverlap\t&quot; .             $hit-&gt;overlap . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tn\t&quot; .                   $hit-&gt;n . &quot;\n&quot;; </span>
<span class="c">#      print &quot;Hit\tlogical_length\t&quot; .      $hit-&gt;logical_length . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tlength_aln\t&quot; .          $hit-&gt;length_aln . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tgaps\t&quot; .                $hit-&gt;gaps . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tfrac_identical\t&quot; .      $hit-&gt;frac_identical . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tfrac_conserved\t&quot; .      $hit-&gt;frac_conserved . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tfrac_aligned_query\t&quot; .  $hit-&gt;frac_aligned_query . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tfrac_aligned_hit\t&quot; .    $hit-&gt;frac_aligned_hit . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tnum_unaligned_sbjct\t&quot; . $hit-&gt;num_unaligned_sbjct . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tnum_unaligned_hit\t&quot; .   $hit-&gt;num_unaligned_hit . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tnum_unaligned_query\t&quot; . $hit-&gt;num_unaligned_query . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tstrand\t&quot; .              $hit-&gt;strand . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tframe\t&quot; .               $hit-&gt;frame . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\trank\t&quot; .                $hit-&gt;rank . &quot;\n&quot;;</span>
<span class="c">#      print &quot;Hit\tlocus\t&quot; .               $hit-&gt;locus . &quot;\n&quot;;</span>
<span class="c">#</span>
   <span class="s">}</span>
<span class="s">}</span>

<a name="__END__-"></a><span class="k">__END__</span>
<a name="EOF-"></a></pre>
</body>
</html>
