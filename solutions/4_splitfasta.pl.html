<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>splitfasta.pl</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<style type="text/css">
<!--
/* default style sheet generated by perltidy */
body {background: #FFFFFF; color: #000000}
pre { color: #000000; 
      background: #F0F0F0;
      font-family: courier;
    } 

.c  { color: #228B22;} /* comment */
.cm { color: #000000;} /* comma */
.co { color: #000000;} /* colon */
.h  { color: #CD5555; font-weight:bold;} /* here-doc-target */
.hh { color: #CD5555; font-style:italic;} /* here-doc-text */
.i  { color: #00688B;} /* identifier */
.j  { color: #CD5555; font-weight:bold;} /* label */
.k  { color: #8B008B; font-weight:bold;} /* keyword */
.m  { color: #FF0000; font-weight:bold;} /* subroutine */
.n  { color: #B452CD;} /* numeric */
.p  { color: #000000;} /* paren */
.pd { color: #228B22; font-style:italic;} /* pod-text */
.pu { color: #000000;} /* punctuation */
.q  { color: #CD5555;} /* quote */
.s  { color: #000000;} /* structure */
.sc { color: #000000;} /* semicolon */
.v  { color: #B452CD;} /* v-string */
.w  { color: #000000;} /* bareword */
-->
</style>
<body style="background-color: white">
<a name="-top-"></a>
<h1>splitfasta.pl</h1>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#pseudocode">PSEUDOCODE</a></li>
	</ul>

	<li><a href="#installing">INSTALLING</a></li>
	<li><a href="#running">RUNNING</a></li>
	<li><a href="#options">OPTIONS</a></li>
	<li><a href="#version_history">VERSION HISTORY</a></li>
	<li><a href="#todo">TODO</a></li>
	<li><a href="#bugs">BUGS</a></li>
	<li><a href="#license">LICENSE</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#contributors">CONTRIBUTORS</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p></p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>splitfasta.pl - split a fasta sequence into overlapping seqments</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p><strong>splitfasta.pl</strong> [<strong>-v|--version</strong> | [<strong>-?|-h|--help</strong>] |
  <strong>[-s|--segment_length</strong> value] <strong>[-l|--overlap_length</strong> value
  inputfastafile</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>This program will allow you to read a fasta sequence and split it into
a number of overlapping sequences.</p>
<p>
</p>
<h2><a name="pseudocode">PSEUDOCODE</a></h2>
<pre>
  read in line {
     if on a header, print out the rest of the prev seq
     store the header or add residues to seq
     repeat until false {
         if the length of the split seq has been read in 
             create a new sequence and print it
         if overlap has been defined, take it from printed
             segment and add it back to seq
    }
  }
  create a new sequence and print rest of the residues</pre>
<p>
</p>
<hr />
<h1><a name="installing">INSTALLING</a></h1>
<p>There are no external dependencies to this program. Just use a
reasonably recent perl (&gt; 5.6) and you will be fine.</p>
<p>
</p>
<hr />
<h1><a name="running">RUNNING</a></h1>
<p>You run the program by changing the options and giving it a fasta file
name to work on.</p>
<p>
</p>
<hr />
<h1><a name="options">OPTIONS</a></h1>
<dl>
<dt><strong><a name="item__2dv__7c__2d_2dversion"><strong>-v | --version</strong></a></strong>

<dd>
<p>Print out a line with the program name and version number.</p>
</dd>
</li>
<dt><strong><a name="item__2d_3f__7c__2dh__7c__2d_2dhelp"><strong>-? | -h | --help</strong></a></strong>

<dd>
<p>Show this help.</p>
</dd>
</li>
<dt><strong><a name="item__2ds_7c_2d_2dsegment_length_value"><strong>-s|--segment_length</strong> value</a></strong>

<dd>
<p>The lenght of the new sequences. Defaults to 10,000.</p>
</dd>
</li>
<dt><strong><a name="item__2ds_7c_2d_2doverlap_length_value"><strong>-s|--overlap_length</strong> value</a></strong>

<dd>
<p>The lenght of the overlap between subsequent sequences. Defaults to 1,000.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="version_history">VERSION HISTORY</a></h1>
<pre>
  0.0.0, 27 Feb 2007, start of the project
  0.2.0, 27 Feb 2007, first public version
  0.3.0, 28 Feb 2007, first public version</pre>
<p>
</p>
<hr />
<h1><a name="todo">TODO</a></h1>
<p>- more docs into description</p>
<p>
</p>
<hr />
<h1><a name="bugs">BUGS</a></h1>
<p>Please report bugs to the author.</p>
<p>
</p>
<hr />
<h1><a name="license">LICENSE</a></h1>
<p>You may distribute this program under the same terms as perl itself.</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Heikki Lehvaslaiho, heikki a sanbi ac za</p>
<p>
</p>
<hr />
<h1><a name="contributors">CONTRIBUTORS</a></h1>
<p>no contributors, yet</p>

<hr /><pre>#!/usr/bin/env perl

<span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
<span class="k">use</span> <span class="w">warnings</span><span class="sc">;</span>
<span class="c">#use diagnostics;</span>
<span class="k">use</span> <span class="w">Getopt::Long</span><span class="sc">;</span>

<span class="k">use</span> <span class="w">constant</span> <span class="i">PROGRAMME_NAME</span> <span class="cm">=&gt;</span> <span class="q">&#39;splitfasta.pl&#39;</span><span class="sc">;</span>
<span class="k">use</span> <span class="w">constant</span> <span class="i">VERSION</span> <span class="cm">=&gt;</span> <span class="q">&#39;0.2&#39;</span><span class="sc">;</span>

<span class="k">my</span> <span class="s">(</span><span class="i">$OUTPUT</span><span class="cm">,</span> <span class="i">$SEGMENT_LENGTH</span><span class="cm">,</span> <span class="i">$OVERLAP_LENGTH</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="n">10000</span><span class="cm">,</span> <span class="n">1000</span><span class="s">)</span><span class="sc">;</span>
<span class="i">GetOptions</span><span class="s">(</span>
           <span class="q">&#39;v|version&#39;</span>          <span class="cm">=&gt;</span> <span class="k">sub</span><span class="s">{</span> <span class="k">print</span> <span class="i">PROGRAMME_NAME</span><span class="cm">,</span> <span class="q">&quot;, version &quot;</span><span class="cm">,</span> <span class="i">VERSION</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span>
                                        <span class="k">exit</span><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span> <span class="s">}</span><span class="cm">,</span>
	   <span class="q">&#39;h|help|?&#39;</span>           <span class="cm">=&gt;</span> <span class="k">sub</span><span class="s">{</span> <span class="k">exec</span><span class="s">(</span><span class="q">&#39;perldoc&#39;</span><span class="cm">,</span><span class="i">$0</span><span class="s">)</span><span class="sc">;</span> <span class="k">exit</span> <span class="n">0</span> <span class="s">}</span><span class="cm">,</span>
           <span class="q">&#39;o|output&#39;</span>           <span class="cm">=&gt;</span> \<span class="i">$OUTPUT</span><span class="cm">,</span>
           <span class="q">&#39;s|segmentlength:i&#39;</span>  <span class="cm">=&gt;</span> \<span class="i">$SEGMENT_LENGTH</span><span class="cm">,</span>
           <span class="q">&#39;l|overlaplength:i&#39;</span>  <span class="cm">=&gt;</span> \<span class="i">$OVERLAP_LENGTH</span>
	   <span class="s">)</span><span class="sc">;</span>


<span class="c"># ---------------------------------------</span>
<span class="c"># open input file and output file</span>
<span class="k">my</span> <span class="i">$INPUT</span> = <span class="k">shift</span><span class="sc">;</span>
<span class="k">open</span><span class="s">(</span><span class="w">IN</span><span class="cm">,</span> <span class="i">$INPUT</span><span class="s">)</span> || <span class="k">die</span> <span class="s">(</span><span class="q">&quot;Cannot open $INPUT. $!&quot;</span><span class="s">)</span><span class="sc">;</span>

<span class="k">if</span> <span class="s">(</span><span class="i">$OUTPUT</span><span class="s">)</span> <span class="s">{</span>
    <span class="k">open</span><span class="s">(</span><span class="w">OUT</span><span class="cm">,</span> <span class="q">&quot;&gt;$OUTPUT&quot;</span><span class="s">)</span> || <span class="k">die</span> <span class="s">(</span><span class="q">&quot;Cannot open $OUTPUT&quot;</span><span class="s">)</span><span class="sc">;</span>
<span class="s">}</span> <span class="k">else</span> <span class="s">{</span>
    <span class="i">*OUT</span> = <span class="i">*STDOUT</span><span class="sc">;</span>
<span class="s">}</span>

<span class="c"># variables</span>
<span class="k">my</span> <span class="i">$seq</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>   <span class="c"># sequence residues</span>
<span class="k">my</span> <span class="i">$header</span><span class="sc">;</span>     <span class="c"># contents of the header llne</span>
<span class="k">my</span> <span class="i">$id</span><span class="sc">;</span>         <span class="c"># seq id from the $header</span>
<span class="k">my</span> <span class="i">$seqcounter</span><span class="sc">;</span> <span class="c"># segment count</span>
<span class="k">my</span> <span class="i">$start</span><span class="sc">;</span>      <span class="c"># pointer to the original seq loc</span>

<span class="k">while</span> <span class="s">(</span><span class="q">&lt;IN&gt;</span><span class="s">)</span> <span class="s">{</span>
    <span class="k">chomp</span><span class="sc">;</span>
    <span class="k">if</span> <span class="s">(</span><span class="q">/^&gt;/</span><span class="s">)</span> <span class="s">{</span>
        <span class="c"># the header line starts a new sequence</span>

        <span class="c"># print out last residues from previous seq</span>
        <span class="k">print</span> <span class="i">OUT</span> <span class="q">&quot;&gt;$id-&quot;</span><span class="cm">,</span> <span class="i">$seqcounter</span>++<span class="cm">,</span> <span class="q">&quot; start=$start\n$seq\n&quot;</span> <span class="k">if</span> <span class="i">$seq</span><span class="sc">;</span>

        <span class="i">$header</span> = <span class="i">$_</span><span class="sc">;</span>
        <span class="s">(</span><span class="i">$id</span><span class="s">)</span> = <span class="i">$header</span> =~ <span class="q">/(\w+)/</span><span class="sc">;</span>
        <span class="i">$seq</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
        <span class="i">$seqcounter</span> = <span class="n">0</span><span class="sc">;</span>
        <span class="i">$start</span> = <span class="n">1</span><span class="sc">;</span>
    <span class="s">}</span> <span class="k">else</span> <span class="s">{</span>
        <span class="q">s/[^a-zA-Z]//g</span><span class="sc">;</span>
        <span class="i">$seq</span> .= <span class="i">$_</span><span class="sc">;</span>
    <span class="s">}</span>

    <span class="k">while</span> <span class="s">(</span><span class="k">length</span><span class="s">(</span><span class="i">$seq</span><span class="s">)</span> &gt;= <span class="i">$SEGMENT_LENGTH</span><span class="s">)</span> <span class="s">{</span>
        <span class="c">#substr EXPR,OFFSET,LENGTH,REPLACEMENT</span>
        <span class="k">my</span> <span class="i">$seqment</span> = <span class="k">substr</span> <span class="i">$seq</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$SEGMENT_LENGTH</span><span class="cm">,</span> <span class="q">&#39;&#39;</span><span class="sc">;</span>
        <span class="k">print</span> <span class="i">OUT</span> <span class="q">&quot;&gt;$id-&quot;</span><span class="cm">,</span> <span class="i">$seqcounter</span>++<span class="cm">,</span> <span class="q">&quot; start=$start\n$seqment\n&quot;</span><span class="sc">;</span>

        <span class="c"># deal with overlap</span>
        <span class="k">if</span> <span class="s">(</span><span class="i">$OVERLAP_LENGTH</span><span class="s">)</span> <span class="s">{</span>
            <span class="i">$seq</span> = <span class="k">substr</span><span class="s">(</span><span class="i">$seqment</span><span class="cm">,</span> <span class="n">-1</span>*<span class="i">$OVERLAP_LENGTH</span><span class="cm">,</span> <span class="i">$OVERLAP_LENGTH</span><span class="s">)</span> . <span class="i">$seq</span><span class="sc">;</span>
        <span class="s">}</span>
        <span class="i">$start</span> = <span class="i">$start</span> + <span class="i">$SEGMENT_LENGTH</span> - <span class="i">$OVERLAP_LENGTH</span><span class="sc">;</span>

    <span class="s">}</span>
<span class="s">}</span>
<span class="c"># print out last residues from previous seq</span>
<span class="k">print</span> <span class="i">OUT</span> <span class="q">&quot;&gt;$id-&quot;</span><span class="cm">,</span> <span class="i">$seqcounter</span>++<span class="cm">,</span> <span class="q">&quot; start=$start\n$seq\n&quot;</span> <span class="k">if</span> <span class="i">$seq</span><span class="sc">;</span>



</pre><pre></pre></body>

</html>
